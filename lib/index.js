!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.dataset=e():t.dataset=e()}(window,(function(){return function(t){var e={};function s(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=e,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(r,o,function(e){return t[e]}.bind(null,o));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);var r={default:"default",hide:"hide",hover:"hover",active:"active",disabled:"disabled",mixed:"mixed"};function o(t){if(t.__store){t.__store.events=[];let e=t.__store.events;t.on=function(s,r){return e.push({type:s,cb:r}),t},t.off=function(s,r){for(let t=0;t<e.length;t++)if(void 0===r)e=[];else{let o=e[t];o.type===s&&o.cb===r&&(e.splice(t,1),t--)}return t},t.once=function(e,s){return t.on(e,(function(...r){fn.apply(t,r),self.off(e,s)}))},t.dispatchEvent=function(s,r){return e.forEach(e=>{e.type===s&&e.cb.call(t,{type:s,option:r})}),t}}}var n=class extends Object{constructor(t,e,s){super(),this.__store=Object.create(null),this.__store.state=r.default,this.__store.row=void 0,this.__store.col=void 0,this.__store.option=e,this.__store.data=t,this.__store.datasets=[s],o(this)}get datasets(){return this.__store.datasets}get data(){return this.__store.data}get value(){return this.__store.data[this.__store.option.value]}get text(){return this.__store.data[this.__store.option.text]}set row(t){void 0===this.__store.row&&(this.__store.row=t)}get row(){return this.__store.row}set col(t){void 0===this.__store.col&&(this.__store.col=t)}get col(){return this.__store.col}get option(){return this.__store.option}get state(){return this.__store.state}set state(t){r[t]&&this.__store.state!==r[t]&&(this.dispatchEvent("change",{name:"cell",value:r[t],data:this}),this.datasets.forEach(e=>{e.dispatchEvent("change",{name:"cell",value:r[t],data:this})})),this.__store.state=r[t]}};class a extends Array{constructor(t,e){super(),this.__store=Object.create(null),this.__store.__name=t,this.__store.__option=e,this.__store.dataset=null,o(this)}set dataset(t){this.__store.dataset=t}get dataset(){return this.__store.dataset}get name(){return this.__store.__name}get option(){return this.__store.__option}get state(){let t=this[0].state;for(let e=1;e<this.length;e++)if(this[e].state!==t){t="mixed";break}return t}set state(t){if(r[t]&&this.state!==r[t]){this.forEach(e=>{e.state=r[t]});let e=null;this instanceof i?e={name:"row",value:r[t],data:this}:this instanceof _&&(e={name:"col",value:r[t],data:this}),this.dispatchEvent("change",e),this.dataset&&this.dataset.dispatchEvent("change",e)}}}class i extends a{}class _ extends a{}class h extends Array{constructor(t,e){super(),t.forEach((t,s)=>{let r=t;t instanceof n?r.datasets.push(this):r=new n(t,e,this),this[s]=r}),this.__store=Object.create(null);let s=this.__store;s.__option=e,s.__deps=[],s.__rows=[],s.__rows=function(t=[],e){let{row:s,col:r}=e,o=[];if("*"===s){let s=new i("*",e);t.forEach(t=>{s.push(t)}),o.push(s.sort(n))}else{let r=Object.create(null);t.forEach(t=>{let o=t.__store.data;r[o[s]]||(r[o[s]]=new i(o[s],e)),r[o[s]].push(t)});for(let t in r){let e=r[t].sort(n);o.push(e)}}return o.forEach((e,s)=>{e.dataset=t,e.forEach((t,e)=>{t.row=s,t.col=e})}),o;function n(t,e){if(r)return t.data[r]>e.data[r]?1:-1}}(this,e),o(this)}get option(){return this.__store.__option}get cols(){let t=[],e=0;this.__store.__rows.forEach(t=>{t.length>e&&(e=t.length)});for(let s=0;s<e;s++){let e=new _;e.dataset=this,this.__store.__rows.forEach(t=>{e.push(t[s])}),t.push(e)}return t}get rows(){return this.__store.__rows}resetState(t="default"){let e=[];this.forEach(s=>{s.state!==t&&(e.push(s),s.state=t)}),this.dispatchEvent("change",{name:"reset",data:e})}selectRows(t){let e=this.option.row,s=[];return this.forEach(r=>{-1!==t.indexOf(r.data[e])&&s.push(r)}),new h(s,this.option)}addDep(t){this.__store.__deps.push(t)}}var u=h;e.default=u}])}));
//# sourceMappingURL=index.js.map